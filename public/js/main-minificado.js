const transformarJSaPHP=()=>{const e=document.getElementById("codigoJS"),t=document.getElementById("codigoPHP"),s=document.getElementById("temaSelect").value,r=e.value.trim();if(r)if(""!==s)try{let e=r;switch(s){case"variables":e=r.replace(/\b(let|const|var)\s+(\w+)/g,"$$$2;"),e="<?php\n"+e+"\n?>";break;case"funciones":e=e.replace(/(const|let|var)\s+/g,""),e=e.replace(/function\s+(\w+)?\s*\((.*?)\)\s*{/g,(e,t,s)=>{const r=s.split(",").map(e=>e.trim()).filter(e=>e).map(e=>"$"+e).join(", ");return`function ${t||""}(${r}) {`}),e=e.replace(/(\w+)?\s*=\s*\((.*?)\)\s*=>\s*{([^}]+)}/g,(e,t,s,r)=>{const c=s.split(",").map(e=>e.trim()).filter(e=>e).map(e=>"$"+e).join(", ");return`function ${t||""}(${c}) {\n${r}\n}`}),e=e.replace(/(\w+)?\s*=\s*\((.*?)\)\s*=>\s*(.+);/g,(e,t,s,r)=>{const c=s.split(",").map(e=>e.trim()).filter(e=>e).map(e=>"$"+e).join(", ");return`function ${t||""}(${c}) {\nreturn ${r.replace(/(\b\w+\b)/g,e=>e.startsWith("$")?e:"$"+e)};\n}`}),e=e.replace(/return\s+(.*?);/g,(e,t)=>`return ${t.replace(/(\b\w+\b)/g,e=>e.startsWith("$")?e:"$"+e)};`),e=e.replace(/(\w+)\s*=\s*function\s*\((.*?)\)\s*{/g,(e,t,s)=>{const r=s.split(",").map(e=>e.trim()).filter(e=>e).map(e=>"$"+e).join(", ");return`function ${t}(${r}) {`}),e=e.replace(/(\w+)\s*=\s*function\s*\((.*?)\)\s*=>\s*(.+);/g,(e,t,s,r)=>{const c=s.split(",").map(e=>e.trim()).filter(e=>e).map(e=>"$"+e).join(", ");return`function ${t}(${c}) {\nreturn ${r.replace(/(\b\w+\b)/g,e=>e.startsWith("$")?e:"$"+e)};\n}`}),e=e.replace(/console\.log\s*\((.*?)\);/g,"echo $1;"),e="<?php\n"+e+"\n?>";break;case"estructurasControl":e=r.split("\n").map(e=>e.match(/\b(let|const|var)\s+\w+/)?e.replace(/\b(let|const|var)\s+(\w+)/g,"$$$2"):e).join("\n"),e=e.split("\n").map(e=>e.trim().startsWith("if")&&e.match(/\bif\s*\(.*\)\s*{/)?e.replace(/if\s*\((.*?)\)\s*{/,(e,t)=>{const s=t.replace(/\b(\w+)\b/g,(e,t)=>isNaN(t)?"$"+t:t);return`if (${s}) {`}):e.trim().startsWith("else if")&&e.match(/\belse\s*if\s*\(.*\)\s*{/)?e.replace(/else if\s*\((.*?)\)\s*{/,(e,t)=>{const s=t.replace(/\b(\w+)\b/g,(e,t)=>isNaN(t)?"$"+t:t);return`elseif (${s}) {`}):e.trim().startsWith("else")&&e.match(/\belse\s*{/)?e.replace(/else\s*{/,"else {"):e.trim().startsWith("while")?e.replace(/while\s*\(([^)]+)\)\s*{/,(e,t)=>{const s=t.replace(/\b(\w+)\b/g,(e,t)=>isNaN(t)?"$"+t:t);return`while (${s}) {`}):e.trim().startsWith("for")?e.replace(/for\s*\(([^)]+)\)\s*{/,(e,t)=>{const s=t.replace(/\b(\w+)\b/g,(e,t)=>isNaN(t)?"$"+t:t);return`for (${s}) {`}):e.trim().startsWith("console.log")?e.replace(/console\.log\s*\((.*?)\);/,"echo $1;"):(e=e.replace(/" \+ /g,'" . '),e.replace(/([^$a-zA-Z0-9_])(\w+)/g,(e,t,s)=>""===t.trim()?e:t+"$"+s))).join("\n"),e="<?php\n"+e+"\n?>";break;case"arrays":e=e.replace(/\b(?:let|const|var)\s+(\w+)\s*=\s*\[(.*?)\];/g,(e,t,s)=>{const r=s.split(",").map(e=>{const t=e.trim();return t.match(/^['"].*['"]$/)?t:"$"+t}).join(", ");return`$${t} = array(${r});\nprint_r($${t});`});break;case"clasesYObjetos":e=r.replace(/class\s+(\w+)\s*{/g,"class $1 {"),e=e.replace(/constructor\s*\((.*?)\)\s*{/g,"public function __construct($1) {"),e=e.replace(/public function __construct\((.*?)\) {/g,(e,t)=>{const s=t.split(",").map(e=>e.trim().startsWith("$")?e.trim():"$"+e.trim()).join(", ");return`public function __construct(${s}) {`}),e=e.replace(/this\.(\w+)\s*=\s*(.*?);/g,"$this->$1 = $2;"),e=e.replace(/(\w+)\s*\(\)\s*{/g,"public function $1() {"),e=e.replace(/`(.*?)`/g,'"$1"'),e=e.replace(/this\.(\w+)/g,"$this->$1"),e=e.replace(/const\s+(\w+)\s*=\s*new\s+(\w+)\s*\((.*?)\);/g,"$$1 = new $2($3);"),e=e.replace(/(\w+)\.(\w+)\(\);/g,"$$1->$2();"),e="<?php\n"+e+"\n?>";break;default:throw new Error("Tema no reconocido")}e=e.replace(/console\.log\s*\((.*?)\);/g,"echo $1;"),t.value=e}catch(e){Swal.fire({title:"Error",text:e.message,icon:"error",confirmButtonText:"Aceptar"})}else Swal.fire({title:"Tema no seleccionado",text:"Por favor, selecciona un tema.",icon:"warning",confirmButtonText:"Aceptar"});else Swal.fire({title:"Campo vacío",text:"Por favor, ingresa el código JavaScript.",icon:"warning",confirmButtonText:"Aceptar"})},limpiarCampos=()=>{document.getElementById("codigoJS").value="",document.getElementById("codigoPHP").value="",document.getElementById("temaSelect").selectedIndex=0},copiarAlPortapapeles=()=>{const e=document.getElementById("codigoPHP");e.select(),document.execCommand("copy"),Swal.fire({title:"Copiado",text:"El código PHP ha sido copiado al portapapeles.",icon:"success",confirmButtonText:"Aceptar"})};